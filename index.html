<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>脱出ゲーム ヒント一覧</title>
  <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@400;700&family=Noto+Serif+JP:wght@300;400;700&display=swap" rel="stylesheet">
  <style>
    :root{
      --paper-ink:#2e1f12;
      --accent-mid:#9b7d5c;
      --accent-dark:#6b4f37;
      --paper-bg:#f5ead6;
    }

    html,body{height:100%}
    body{
      margin:0;
      padding:2rem 1rem;
      font-family: "Noto Serif JP", Georgia, "Times New Roman", serif;
      background:
        radial-gradient(circle at 10% 10%, rgba(245,230,200,0.35), transparent 12%),
        radial-gradient(circle at 90% 90%, rgba(230,210,170,0.30), transparent 12%),
        linear-gradient(180deg, #efe6d1 0%, #f9f5ec 40%, #efe6d1 100%);
      color:var(--paper-ink);
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
      line-height:1.6;
    }

    body::before{
      content:"";
      position:fixed;
      inset:0;
      pointer-events:none;
      background-image: radial-gradient(rgba(0,0,0,0.02) 1px, transparent 1px);
      background-size:6px 6px;
      mix-blend-mode:multiply;
      opacity:0.6;
    }

    .container{
      max-width:820px;
      margin:0 auto;
      padding:1.5rem;
      background: linear-gradient(180deg, rgba(255,251,240,0.95), rgba(244,232,210,0.98));
      border-radius:12px;
      border:1px solid rgba(107,79,55,0.15);
      box-shadow: 0 6px 18px rgba(0,0,0,0.12);
    }

    header{ text-align:center; margin-bottom:1rem; position:relative; padding-bottom:0.4rem; }
    h1{
      font-family:"Cormorant Garamond", serif;
      margin:0;
      font-weight:700;
      letter-spacing:0.06em;
      font-size:clamp(1.25rem, 4.5vw, 2.5rem);
      color:var(--accent-dark);
    }
    h2{ margin:0.35rem 0 0; font-family:"Cormorant Garamond", serif; font-weight:400; font-size:clamp(0.9rem,3.6vw,1.6rem); color:var(--accent-mid); }
    .explain{ margin-top:0.6rem; margin-bottom:0.6rem; font-size:clamp(0.78rem,2.2vw,1.05rem); color:var(--paper-ink); line-height:1.45; }

    /* summary の装飾（左の / 風は summary のみに）*/
    .details{
      margin:0.9rem 0;
      border-radius:8px;
      position:relative;
      border:1px solid rgba(90,65,45,0.12);
      background: linear-gradient(180deg, rgba(255,255,250,0.9), rgba(247,240,228,0.95));
      box-shadow: 0 6px 14px rgba(0,0,0,0.06);
      overflow:visible;
    }

    /* ここでは装飾を summary::before にして、高さが伸びないようにする */
    .summary{
      display:block;
      cursor:pointer;
      font-weight:700;
      padding:12px 18px;
      margin:0;
      background:transparent;
      border:none;
      color:var(--accent-dark);
      font-size:1rem;
      font-family:"Cormorant Garamond", serif;
      letter-spacing:0.02em;
      position:relative;
      user-select:none;
    }

    .summary::before{
      content:"/";
      position:absolute;
      left:12px;
      top:50%;
      transform:translateY(-50%) rotate(-18deg);
      font-size:1.25rem;
      color:rgba(107,79,55,0.9);
      opacity:0.95;
      pointer-events:none;
      /* 固定表示にすることで展開で伸びない */
    }

    .summary::after{
      content:"◆";
      position:absolute;
      right:14px;
      top:50%;
      transform:translateY(-50%) rotate(0deg);
      font-size:0.9rem;
      color:var(--accent-mid);
      transition:transform .24s ease, color .24s ease;
    }
    .details[open] > .summary::after{
      transform:translateY(-50%) rotate(180deg);
      color:var(--accent-dark);
    }

    /* 回答領域 */
    .answer{
      overflow:hidden;
      opacity:0;
      height:0;
      transition: height 0.26s ease, opacity 0.22s ease;
      will-change: height, opacity;
    }

    .details[open] > .answer{ opacity:1; }

    .answerInner{
      padding:12px 18px;
      border-top:1px dashed rgba(120,90,60,0.08);
      font-size:0.98rem;
      color:var(--paper-ink);
      line-height:1.6;
      background: linear-gradient(180deg, rgba(255,255,255,0), rgba(250,245,235,0.02));
    }

    /* ネストする小さな details はインデントして見やすく */
    .details .details{
      margin:0.6rem 0 0 0.6rem;
      border-radius:6px;
      padding-left:0.4rem;
      background: linear-gradient(180deg, rgba(250,247,238,0.9), rgba(245,236,214,0.92));
    }
    .details .details > .summary{ padding:8px 12px; font-size:0.95rem; font-weight:600; }
    .details .details > .answerInner{ padding:8px 12px; font-size:0.95rem; }

    @media (max-width:640px){
      .container{ padding:1rem; }
      .summary{ padding:10px 14px; font-size:0.98rem; }
      .answerInner{ padding:10px 14px; font-size:0.95rem; }
      .summary::before{ left:10px; font-size:1.05rem; }
    }

    /* 微調整の視覚効果 */
    .summary:focus{ box-shadow:0 0 0 4px rgba(155,125,92,0.08); border-radius:6px; outline:none; }
  </style>
</head>
<body>
  <div class="container" id="hintContainer">
    <header>
      <h1>魔法学校からの脱出</h1>
      <h2>Escape from Magic School</h2>
      <p class="explain">
        これはコスモシアからの脱出のヒントページです<br>
        チーム内全体でヒントを見ることを決めてから見てください
      </p>
    </header>

    <!-- ==== トップレベルの details はすべて siblings に配置（ネストを修正） ==== -->
    <details class="details">
      <summary class="summary">居住モジュールへの入り方</summary>
      <div class="answer">
        <div class="answerInner">Q1からQ4を解き、データベースからキーを入手する
          <details class="details">
            <summary class="summary">Q1のヒント</summary>
            <div class="answer"><div class="answerInner">線を記号同士でつなげ</div></div>
          </details>
          <details class="details">
            <summary class="summary">Q2のヒント</summary>
            <div class="answer"><div class="answerInner">展開図を組み立てろ</div></div>
          </details>
          <details class="details">
            <summary class="summary">Q3のヒント</summary>
            <div class="answer"><div class="answerInner">50音表を考えろ</div></div>
          </details>
          <details class="details">
            <summary class="summary">Q4のヒント</summary>
            <div class="answer"><div class="answerInner">イラストを文字に直せ</div></div>
          </details>
          <details class="details">
            <summary class="summary">キー入手</summary>
            <div class="answer"><div class="answerInner">頭とは、頭文字のこと
              <details class="details">
                <summary class="summary">追加ヒント</summary>
                <div class="answer"><div class="answerInner">頭文字をデータベースから探し、その中の文字がキー</div></div>
              </details>
            </div></div>
          </details>
        </div>
      </div>
    </details>

    <details class="details">
      <summary class="summary">居住モジュールの謎</summary>
      <div class="answer">
        <div class="answerInner">日誌を読み、指示に従い、暗号化されたファイルを解読して情報を得る
          <details class="details">
            <summary class="summary">◇のヒント</summary>
            <div class="answer"><div class="answerInner">イラストを文字に直して当てはめろ</div></div>
          </details>
          <details class="details">
            <summary class="summary">〇のヒント</summary>
            <div class="answer"><div class="answerInner">猫は英語でCAT
              <details class="details">
                <summary class="summary">追加ヒント</summary>
                <div class="answer"><div class="answerInner">3番目のアルファベットはC</div></div>
              </details>
            </div></div>
          </details>
          <details class="details">
            <summary class="summary">△のヒント</summary>
            <div class="answer"><div class="answerInner">スマホの日本語入力</div></div>
          </details>
          <details class="details">
            <summary class="summary">×のヒント</summary>
            <div class="answer"><div class="answerInner">四角の状態は、矢印によって対比を表されている
              <details class="details">
                <summary class="summary">追加ヒント</summary>
                <div class="answer"><div class="answerInner">見えないものを見るには、表面だけでなく裏面も重要</div></div>
              </details>
            </div></div>
          </details>
          <details class="details">
            <summary class="summary">メモのヒント</summary>
            <div class="answer"><div class="answerInner">足し算の繰り上げは1しかありえない
              <details class="details">
                <summary class="summary">追加ヒント</summary>
                <div class="answer"><div class="answerInner">bを足しても変わらないならbは？</div></div>
              </details>
            </div></div>
          </details>
          <details class="details">
            <summary class="summary">電源のヒント</summary>
            <div class="answer"><div class="answerInner">日誌の裏にあるのが配線
              <details class="details">
                <summary class="summary">追加ヒント</summary>
                <div class="answer"><div class="answerInner">正しい色は、ラッキーカラー</div></div>
              </details>
            </div></div>
          </details>
          <details class="details">
            <summary class="summary">解読のヒント</summary>
            <div class="answer"><div class="answerInner">◇と〇を合わせて、穴に入った文字を読め</div></div>
          </details>
        </div>
      </div>
    </details>

    <details class="details">
      <summary class="summary">実験モジュールへの入り方</summary>
      <div class="answer">
        <div class="answerInner">Q5からQ8を解き、データベースからキーを入手する
          <details class="details">
            <summary class="summary">Q5のヒント</summary>
            <div class="answer"><div class="answerInner">1年は12か月
              <details class="details">
                <summary class="summary">追加ヒント</summary>
                <div class="answer"><div class="answerInner">3月は英語でmarch</div></div>
              </details>
            </div></div>
          </details>
          <details class="details">
            <summary class="summary">Q6のヒント</summary>
            <div class="answer"><div class="answerInner">1つめのイラストはしょうじ</div></div>
          </details>
          <details class="details">
            <summary class="summary">Q7のヒント</summary>
            <div class="answer"><div class="answerInner">「こ」に上の矢印で「け」になる
              <details class="details">
                <summary class="summary">追加ヒント</summary>
                <div class="answer"><div class="answerInner">3月は英語でmarch</div></div>
              </details>
            </div></div>
          </details>
          <details class="details">
            <summary class="summary">Q8のヒント</summary>
            <div class="answer"><div class="answerInner">ローマ字と記号から考えろ</div></div>
          </details>
          <details class="details">
            <summary class="summary">キー入手のヒント</summary>
            <div class="answer"><div class="answerInner">頭は同じ、その文字を繋げたとき、繋げた線を通る文字は</div></div>
          </details>
        </div>
      </div>
    </details>

    <details class="details">
      <summary class="summary">実験モジュールの謎</summary>
      <div class="answer"><div class="answerInner">RNA配列を解き、ウイルスとワクチンのサンプルを得る
        <details class="details">
          <summary class="summary">解読のヒント</summary>
          <div class="answer"><div class="answerInner">暗いところで星は見れる</div></div>
        </details>
        <details class="details">
          <summary class="summary">翻訳のヒント</summary>
          <div class="answer"><div class="answerInner">周りに初めからヒントはある</div></div>
        </details>
      </div></div>
    </details>

    <details class="details">
      <summary class="summary">コックピットへの入り方</summary>
      <div class="answer"><div class="answerInner">コックピットのコードを入手する
        <details class="details">
          <summary class="summary">手がかりへのヒント</summary>
          <div class="answer"><div class="answerInner">コックピットにも裏面はある</div></div>
        </details>
        <details class="details">
          <summary class="summary">秘密のキーのヒント</summary>
          <div class="answer"><div class="answerInner">RNA配列はQ1からQ8の模様に隠されている
            <details class="details">
              <summary class="summary">追加ヒント</summary>
              <div class="answer"><div class="answerInner">色からRNA配列に変換できる</div></div>
            </details>
          </div></div>
        </details>
        <details class="details">
          <summary class="summary">ポリオミノ4のヒント</summary>
          <div class="answer"><div class="answerInner">1度解いて、もう一度指示通りに解く
            <details class="details">
              <summary class="summary">追加ヒント</summary>
              <div class="answer"><div class="answerInner">赤のミノをポリオミノ1に</div></div>
            </details>
          </div></div>
        </details>
      </div></div>
    </details>

  </div>

  <script>
    (function(){
      const container = document.getElementById('hintContainer');

      // イベントデリゲーションでパフォーマンス改善（リスナー1つ）
      container.addEventListener('click', (e) => {
        const summary = e.target.closest('.summary');
        if (!summary || !container.contains(summary)) return;

        // summary が属する .details を特定
        const detailEl = summary.closest('.details');
        if (!detailEl) return;

        // stop native <details> toggle
        e.preventDefault();

        const answer = detailEl.querySelector('.answer');
        const isOpen = detailEl.hasAttribute('open');

        if (isOpen) {
          // 閉じる：高さを現在の scrollHeight から 0 にトランジション
          const currentH = answer.scrollHeight;
          answer.style.height = currentH + 'px';
          // 少し delay してトランジションを発火（ブラウザ互換）
          requestAnimationFrame(() => {
            answer.style.transition = 'height 0.26s ease, opacity 0.22s ease';
            answer.style.height = '0px';
            answer.style.opacity = '0';
          });

          answer.addEventListener('transitionend', function handler(ev){
            if (ev.propertyName !== 'height') return;
            // 子の open は閉じる（必要なら）
            detailEl.querySelectorAll('.details[open]').forEach(child => child.removeAttribute('open'));
            detailEl.removeAttribute('open');
            // クリーンアップ
            answer.style.removeProperty('height');
            answer.style.removeProperty('transition');
            answer.style.removeProperty('opacity');
            answer.removeEventListener('transitionend', handler);
          }, { once:true });

        } else {
          // 開く： open 属性を付けて 0 -> scrollHeight にトランジション
          detailEl.setAttribute('open','');
          // 初期状態を明示
          answer.style.height = '0px';
          answer.style.opacity = '0';
          requestAnimationFrame(() => {
            const targetH = answer.scrollHeight;
            answer.style.transition = 'height 0.26s ease, opacity 0.22s ease';
            answer.style.height = targetH + 'px';
            answer.style.opacity = '1';
          });

          answer.addEventListener('transitionend', function handler(ev){
            if (ev.propertyName !== 'height') return;
            // 自動高さに戻す
            answer.style.removeProperty('height');
            answer.style.removeProperty('transition');
            answer.removeEventListener('transitionend', handler);
          }, { once:true });
        }
      });

      // キーボード操作対応（Enter / Space で開閉）
      container.addEventListener('keydown', (e) => {
        const summary = e.target.closest('.summary');
        if (!summary) return;
        if (e.key === 'Enter' || e.key === ' ') {
          e.preventDefault();
          summary.click();
        }
      });
    })();
  </script>
</body>
</html>
